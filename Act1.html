<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Herophobia. ACT 1</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Times New Roman', serif;
            cursor: default;
            -webkit-user-select: none;
            -moz-user-select: none;
            user-select: none;
        }

        body {
            background-color: #000;
            overflow: hidden;
            min-height: 100vh;
            position: relative;
            background-size: cover;
            background-position: center;
            transition: background-image 0.3s ease;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: -1;
        }

        /* Чёрный экран после анимации АКТ1 */
        #post-act-fade {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #000;
            z-index: 999;
            opacity: 1;
            pointer-events: none;
            transition: opacity 2s ease;
        }

        /* Анимация появления из черного */
        #fade-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #000;
            z-index: 1000;
            animation: fadeIn 3s ease forwards;
        }

        @keyframes fadeIn {
            0% { opacity: 1; }
            100% { opacity: 0; visibility: hidden; }
        }

        /* Анимация падения букв */
        .act-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            background-color: #000;
        }

        .act-letter {
            font-size: 300px;
            font-weight: bold;
            color: #ff0000;
            margin: 0 40px;
            opacity: 0;
            transform: scale(5) translateY(-1000px);
            text-shadow: 
                0 0 5px #ff0000,
                0 0 10px #cc0000,
                0 0 15px #990000,
                0 0 20px #660000,
                0 0 25px #330000;
        }

        /* Анимация мерцания букв */
        @keyframes flicker {
            0%, 100% { 
                opacity: 1;
                color: #ff0000;
                text-shadow: 
                    0 0 5px #ff0000,
                    0 0 10px #cc0000,
                    0 0 15px #990000;
            }
            50% { 
                opacity: 0.9;
                color: #ee0000;
                text-shadow: 
                    0 0 3px #ff0000,
                    0 0 8px #cc0000,
                    0 0 13px #990000;
            }
        }

        .act-letter.flicker {
            animation: flicker 1.5s infinite alternate;
        }

        /* Затемнение для переходов */
        .transition-fade {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #000;
            opacity: 0;
            z-index: 900;
            pointer-events: none;
            transition: opacity 0.8s ease;
        }

        /* Стиль для хаба Area */
        .area-container, .corridor-container, .harlekab-container, .rooms-left-container, .rooms-right-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-size: cover;
            background-position: center;
            display: none;
            z-index: 10;
        }

        /* Точки-кнопки на Area - убрана обводка и изменен размер */
        .point {
            position: absolute;
            width: 100px;
            height: 100px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 100;
            background-size: cover;
            background-position: center;
            border: none;
            box-shadow: none;
        }

        .point:hover {
            transform: scale(1.1);
        }

        .point.disabled {
            opacity: 0.3;
            cursor: not-allowed;
            pointer-events: none;
            filter: grayscale(100%);
        }

        .point.disabled:hover {
            transform: none;
        }

        /* Стрелки перехода */
        .nav-arrow {
            position: absolute;
            width: 40px;
            height: 40px;
            background: linear-gradient(145deg, 
                rgba(100, 0, 30, 0.8), 
                rgba(60, 0, 15, 0.8));
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            border: 2px solid #800040;
            z-index: 100;
            box-shadow: 
                0 0 15px rgba(100, 0, 30, 0.4),
                inset 0 0 10px rgba(60, 0, 15, 0.3);
            transition: none;
        }

        .nav-arrow.disabled {
            opacity: 0.5;
            cursor: not-allowed;
            border: 2px solid #400020;
        }

        .nav-arrow::after {
            font-size: 24px;
            color: #ffffff;
            font-weight: bold;
        }

        .arrow-right {
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
        }

        .arrow-right::after {
            content: '→';
        }

        .arrow-left {
            left: 20px;
            top: 50%;
            transform: translateY(-50%);
        }

        .arrow-left::after {
            content: '←';
        }

        .arrow-up {
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
        }

        .arrow-up::after {
            content: '↑';
        }

        /* Кнопки комнат в коридорах */
        .room-button {
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(145deg, 
                rgba(100, 0, 30, 0.85), 
                rgba(60, 0, 15, 0.85));
            border: 2px solid #800040;
            border-radius: 10px;
            color: #ffffff;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
            min-width: 250px;
            box-shadow: 
                0 0 15px rgba(100, 0, 30, 0.4),
                inset 0 0 10px rgba(60, 0, 15, 0.3);
            z-index: 100;
            padding: 15px 25px;
            white-space: nowrap;
        }

        .room-button:hover {
            background: linear-gradient(145deg, 
                rgba(120, 0, 40, 0.95), 
                rgba(80, 0, 20, 0.95));
            transform: translateX(-50%) scale(1.05);
            border-color: #a00050;
            box-shadow: 
                0 0 25px rgba(120, 0, 50, 0.6),
                inset 0 0 15px rgba(80, 0, 25, 0.4);
        }

        .room-button.disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .room-button.disabled:hover {
            transform: translateX(-50%);
            background: linear-gradient(145deg, 
                rgba(100, 0, 30, 0.85), 
                rgba(60, 0, 15, 0.85));
            border-color: #800040;
        }

        /* ДИАЛОГОВОЕ ОКНО */
        .dialogue-container {
            position: fixed;
            bottom: 40px;
            left: 60px;
            width: calc(100% - 320px);
            height: 25vh;
            background: linear-gradient(135deg, 
                rgba(60, 0, 20, 0.95), 
                rgba(40, 0, 10, 0.95));
            border: 1px solid rgba(120, 0, 40, 0.8);
            box-shadow: 
                0 0 30px rgba(120, 0, 40, 0.5),
                inset 0 0 20px rgba(80, 0, 20, 0.3);
            z-index: 100;
            display: flex;
            padding: 20px;
            border-radius: 10px;
            backdrop-filter: blur(5px);
            display: none;
            flex-direction: column;
        }

        /* Имя персонажа сверху */
        .character-name-top {
            position: absolute;
            bottom: calc(25vh + 60px);
            left: 60px;
            color: #ffcccc;
            font-size: 1.8rem;
            font-weight: bold;
            text-shadow: 0 0 8px rgba(200, 100, 120, 0.5);
            text-align: left;
            padding: 10px 20px;
            border-radius: 5px;
            background: rgba(40, 0, 10, 0.7);
            z-index: 150;
            max-width: 400px;
            display: none;
        }

        .dialogue-panel {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .dialogue-text {
            color: #ffffff;
            font-size: 1.4rem;
            line-height: 1.5;
            text-shadow: 0 0 5px rgba(255, 255, 255, 0.1);
            min-height: 100px;
            padding: 15px;
            border-radius: 5px;
            background: rgba(30, 0, 10, 0.4);
            overflow-y: auto;
            margin-bottom: 15px;
            transition: all 0.3s ease;
            max-height: calc(25vh - 100px);
            overflow-y: auto;
        }

        /* СТИЛЬ АВТОРСКОЙ РЕЧИ */
        .dialogue-text.narrator {
            font-size: 1.8rem;
            line-height: 1.8;
            text-align: center;
            padding: 20px 40px;
            background: transparent;
            display: flex;
            align-items: center;
            justify-content: center;
            font-style: italic;
            color: #ffd9e3;
            text-shadow: 0 0 10px rgba(255, 200, 220, 0.3);
            min-height: 120px;
            border: none;
            border-radius: 15px;
            margin: 0 auto;
            max-width: 100%;
            word-wrap: break-word;
            overflow-wrap: break-word;
            overflow-y: hidden;
            max-height: calc(25vh - 80px);
        }

        /* Подсказка про пробел */
        .continue-indicator {
            text-align: center;
            color: #ffb3c1;
            font-size: 1.1rem;
            font-style: italic;
            text-shadow: 0 0 5px rgba(200, 100, 120, 0.3);
            animation: pulse 1.5s infinite alternate;
            padding: 8px;
            margin-top: 5px;
        }

        @keyframes pulse {
            0%, 100% { opacity: 0.5; }
            50% { opacity: 1; }
        }

        /* Портрет персонажа */
        .character-portrait {
            position: absolute;
            bottom: 40px;
            right: 60px;
            width: 200px;
            height: 200px;
            object-fit: cover;
            background-color: #1a000a;
            box-shadow: 0 0 20px rgba(80, 0, 20, 0.5);
            z-index: 150;
            display: none;
        }

        /* Эффекты текста */
        .glitch-text {
            color: #ff0000 !important;
            text-shadow: 
                0 0 5px #ff0000,
                0 0 10px #cc0000,
                0 0 15px #990000,
                0 0 20px #660000,
                0 0 25px #330000 !important;
            animation: glitch 0.2s infinite alternate,
                       shake 0.15s infinite alternate,
                       bloodPulse 2s infinite;
            position: relative;
            filter: blur(0.3px);
            letter-spacing: 0.5px;
        }

        @keyframes glitch {
            0%, 100% {
                transform: translate(0);
            }
            20% {
                transform: translate(-2px, 2px);
            }
            40% {
                transform: translate(-2px, -2px);
            }
            60% {
                transform: translate(2px, 2px);
            }
            80% {
                transform: translate(2px, -2px);
            }
        }

        @keyframes shake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-1px); }
            50% { transform: translateX(1px); }
            75% { transform: translateX(-0.5px); }
            100% { transform: translateX(0); }
        }

        @keyframes bloodPulse {
            0%, 100% { 
                opacity: 0.9;
                text-shadow: 
                    0 0 5px #ff0000,
                    0 0 10px #cc0000,
                    0 0 15px #990000;
            }
            50% { 
                opacity: 1;
                text-shadow: 
                    0 0 10px #ff0000,
                    0 0 20px #cc0000,
                    0 0 30px #990000;
            }
        }

        .distorted-text {
            color: #ff6666 !important;
            text-shadow: 
                0 0 15px #ff0000,
                0 0 25px #ff0000 !important;
            animation: distort 0.5s infinite alternate,
                       lag 2s infinite;
            filter: blur(0.8px) contrast(1.5);
        }

        @keyframes distort {
            0% { 
                transform: scale(1);
                letter-spacing: normal;
            }
            100% { 
                transform: scale(1.02);
                letter-spacing: 1px;
            }
        }

        @keyframes lag {
            0%, 100% { opacity: 1; }
            10%, 30%, 50%, 70%, 90% { opacity: 0.9; }
            20%, 40%, 60%, 80% { opacity: 1; }
        }

        /* Эффект землетрясения */
        .earthquake-text {
            color: #ff4444 !important;
            text-shadow: 
                0 0 20px #ff0000,
                0 0 40px #ff0000,
                0 0 60px #ff0000 !important;
            animation: earthquake 0.8s infinite alternate,
                    bloodPulse 1.5s infinite;
            position: relative;
            filter: blur(0.5px) contrast(2);
            letter-spacing: normal;
            display: inline-block;
        }

        @keyframes earthquake {
            0% { 
                transform: translate(0, 0) rotate(0deg); 
            }
            10% { 
                transform: translate(-5px, -3px) rotate(-1deg); 
            }
            20% { 
                transform: translate(6px, 2px) rotate(1deg); 
            }
            30% { 
                transform: translate(-7px, 1px) rotate(0deg); 
            }
            40% { 
                transform: translate(5px, -2px) rotate(1deg); 
            }
            50% { 
                transform: translate(-4px, 3px) rotate(-1deg); 
            }
            60% { 
                transform: translate(7px, -1px) rotate(0deg); 
            }
            70% { 
                transform: translate(-6px, 2px) rotate(-1deg); 
            }
            80% { 
                transform: translate(4px, -3px) rotate(1deg); 
            }
            90% { 
                transform: translate(-3px, 1px) rotate(0deg); 
            }
            100% { 
                transform: translate(5px, -2px) rotate(-1deg); 
            }
        }

        /* Усиленная версия для особо сильных эффектов */
        .earthquake-text.strong {
            animation: earthquakeStrong 0.5s infinite alternate,
                    bloodPulse 1s infinite;
            filter: blur(0.8px) contrast(3) brightness(1.5);
        }

        @keyframes earthquakeStrong {
            0% { 
                transform: translate(0, 0) rotate(0deg);
                color: #ff4444;
            }
            25% { 
                transform: translate(-8px, -5px) rotate(-2deg);
                color: #ff2222;
            }
            50% { 
                transform: translate(10px, 4px) rotate(2deg);
                color: #ff6666;
            }
            75% { 
                transform: translate(-9px, 3px) rotate(-1deg);
                color: #ff3333;
            }
            100% { 
                transform: translate(7px, -4px) rotate(1deg);
                color: #ff5555;
            }
        }

        /* Счётчик диалогов */
        .dialogue-counter {
            position: fixed;
            top: 20px;
            right: 20px;
            color: #ff0000;
            font-size: 24px;
            font-weight: bold;
            text-shadow: 0 0 10px rgba(255, 0, 0, 0.7);
            z-index: 1000;
            background: rgba(0, 0, 0, 0.7);
            padding: 10px 20px;
            border-radius: 5px;
            display: none;
        }

        /* Адаптивность */
        @media (max-width: 1024px) {
            .dialogue-container {
                width: calc(100% - 280px);
            }
            
            .character-portrait {
                width: 180px;
                height: 180px;
            }
            
            .character-name-top {
                left: 40px;
                bottom: calc(25vh + 50px);
            }
            
            .room-button {
                min-width: 200px;
                font-size: 16px;
                padding: 12px 20px;
            }
            
            .dialogue-text.narrator {
                padding: 15px 30px;
                font-size: 1.6rem;
                max-width: 100%;
            }
        }

        @media (max-width: 768px) {
            .act-letter {
                font-size: 200px;
                margin: 0 20px;
            }
            
            .character-portrait {
                width: 150px;
                height: 150px;
                right: 20px;
                bottom: 30px;
            }
            
            .dialogue-container {
                left: 20px;
                width: calc(100% - 190px);
                height: 30vh;
                padding: 15px;
            }
            
            .character-name-top {
                left: 20px;
                bottom: calc(30vh + 50px);
                font-size: 1.5rem;
                max-width: 300px;
            }
            
            .dialogue-text {
                font-size: 1.2rem;
                padding: 10px;
            }
            
            .dialogue-text.narrator {
                font-size: 1.4rem;
                padding: 10px 20px;
                max-width: 100%;
                max-height: calc(30vh - 70px);
            }
            
            .room-button {
                min-width: 180px;
                padding: 10px 15px;
                font-size: 14px;
            }
            
            .point {
                width: 80px;
                height: 80px;
            }
            
            .nav-arrow {
                width: 35px;
                height: 35px;
            }
            
            .nav-arrow::after {
                font-size: 20px;
            }
            
            .dialogue-counter {
                font-size: 18px;
                padding: 8px 15px;
            }
        }

        @media (max-width: 480px) {
            .act-letter {
                font-size: 150px;
                margin: 0 10px;
            }
            
            .character-portrait {
                width: 120px;
                height: 120px;
            }
            
            .dialogue-container {
                height: 35vh;
                padding: 12px;
                width: calc(100% - 150px);
            }
            
            .character-name-top {
                font-size: 1.2rem;
                padding: 8px 15px;
                max-width: 250px;
            }
            
            .dialogue-text {
                font-size: 1rem;
            }
            
            .dialogue-text.narrator {
                font-size: 1.2rem;
                padding: 8px 15px;
                max-width: 100%;
                max-height: calc(35vh - 60px);
            }
            
            .room-button {
                min-width: 160px;
                font-size: 12px;
                padding: 8px 12px;
            }
            
            .point {
                width: 60px;
                height: 60px;
            }
            
            .nav-arrow {
                width: 30px;
                height: 30px;
            }
            
            .nav-arrow::after {
                font-size: 18px;
            }
        }
    </style>
</head>
<body>
    <!-- Начальное затемнение -->
    <div id="fade-overlay"></div>
    
    <!-- Чёрный экран после анимации АКТ1 -->
    <div id="post-act-fade"></div>
    
    <!-- Затемнение для переходов -->
    <div class="transition-fade" id="transitionFade"></div>
    
    <!-- Анимация появления ACT 1 -->
    <div class="act-container" id="actContainer">
        <div class="act-letter" id="letterA">A</div>
        <div class="act-letter" id="letterC">C</div>
        <div class="act-letter" id="letterT">T</div>
        <div class="act-letter" id="letter1">1</div>
    </div>

    <!-- Счётчик диалогов -->
    <div class="dialogue-counter" id="dialogueCounter">0/11</div>

    <!-- Хаб Area -->
    <div class="area-container" id="areaContainer" style="background-image: url('arts/area.jpg');">
        <!-- Стрелки перехода -->
        <button class="nav-arrow arrow-up" id="areaArrowUp"></button>
        <button class="nav-arrow arrow-left" id="areaArrowLeft"></button>
        <button class="nav-arrow arrow-right" id="areaArrowRight"></button>
        
        <!-- Точки-персонажи (100x100 без обводки) -->
        <div class="point" style="top: 20%; left: 15%;" data-name="Пьеро" data-portrait="arts/ref.png" data-image="arts/ПьероАкт1.png"></div>
        <div class="point" style="top: 25%; left: 85%;" data-name="Мизери" data-portrait="arts/ref.png" data-image="arts/МизериАкт1.png"></div>
        <div class="point" style="top: 65%; left: 75%;" data-name="Ригар" data-portrait="arts/ref.png" data-image="arts/РигарАкт1.png"></div>
        <div class="point" style="top: 70%; left: 25%;" data-name="Каррус" data-portrait="arts/ref.png" data-image="arts/КаррусАкт1.png"></div>
        <div class="point" style="top: 50%; left: 80%;" data-name="Гутта" data-portrait="arts/ref.png" data-image="arts/ГуттаАкт1.png"></div>
        <div class="point" style="top: 40%; left: 45%;" data-name="Фата Моргана" data-portrait="arts/ref.png" data-image="arts/ФатаМорганаАкт1.png"></div>
        <div class="point" style="top: 75%; left: 55%;" data-name="Калиостро" data-portrait="arts/ref.png" data-image="arts/КалиостроАкт1.png"></div>
        <div class="point" style="top: 30%; left: 70%;" data-name="Пульсио" data-portrait="arts/ref.png" data-image="arts/ПульсиоАкт1.png"></div>
        <div class="point" style="top: 60%; left: 35%;" data-name="Китагава" data-portrait="arts/ref.png" data-image="arts/КитагаваАкт1.png"></div>
        <div class="point" style="top: 35%; left: 25%;" data-name="Лоскут" data-portrait="arts/ref.png" data-image="arts/ЛоскутАкт1.png"></div>
    </div>

    <!-- Коридор с комнатами слева -->
    <div class="rooms-left-container" id="roomsLeftContainer" style="background-image: url('arts/Corridore.jpg');">
        <!-- Стрелка возврата -->
        <button class="nav-arrow arrow-right" id="roomsLeftArrowRight"></button>
        
        <!-- Кнопки комнат -->
        <div class="room-button disabled" style="top: 10%;" data-room="Пьеро">Комната Пьеро</div>
        <div class="room-button disabled" style="top: 20%;" data-room="Мизери">Комната Мизери</div>
        <div class="room-button disabled" style="top: 30%;" data-room="Фата Моргана">Комната Фата Моргана</div>
        <div class="room-button disabled" style="top: 40%;" data-room="Китагава">Комната Китагавы</div>
        <div class="room-button disabled" style="top: 50%;" data-room="Лоскут">Комната Лоскута</div>
        <div class="room-button disabled" style="top: 60%;" data-room="Каррус">Комната Карруса</div>
    </div>

    <!-- Коридор с комнатами справа -->
    <div class="rooms-right-container" id="roomsRightContainer" style="background-image: url('arts/Corridore.jpg');">
        <!-- Стрелка возврата -->
        <button class="nav-arrow arrow-left" id="roomsRightArrowLeft"></button>
        
        <!-- Кнопки комнат -->
        <div class="room-button disabled" style="top: 10%;" data-room="Ригар">Комната Ригара</div>
        <div class="room-button disabled" style="top: 20%;" data-room="Гутта">Комната Гутты</div>
        <div class="room-button disabled" style="top: 30%;" data-room="Калиостро">Комната Калиостро</div>
        <div class="room-button disabled" style="top: 40%;" data-room="Пульсио">Комната Пульсио</div>
        <div class="room-button disabled" style="top: 50%;" data-room="Фуфу">Комната Фуфу</div>
        <div class="room-button" style="top: 60%;" data-room="Арлекино">Кабинет Арлекино</div>
    </div>

    <!-- Кабинет Арлекино -->
    <div class="harlekab-container" id="harlekabContainer" style="background-image: url('arts/Harlekab.jpg'); display: none;">
        <!-- Стрелка возврата -->
        <button class="nav-arrow arrow-right" id="harlekabArrowRight"></button>
        
        <!-- Точка Арлекино (100x100 без обводки) -->
        <div class="point" style="top: 50%; left: 50%; transform: translate(-50%, -50%);" data-name="Арлекино" data-portrait="arts/HarlequinoACT1.png" data-image="arts/АрлекиноАкт1.png"></div>
    </div>

    <!-- Диалоговое окно -->
    <div class="dialogue-container" id="dialogueContainer">
        <div class="dialogue-panel">
            <div id="dialogueText" class="dialogue-text"></div>
            <div class="continue-indicator">Нажмите ПРОБЕЛ для продолжения...</div>
        </div>
    </div>
    
    <!-- Имя персонажа -->
    <div id="characterNameTop" class="character-name-top"></div>
    
    <!-- Портрет персонажа -->
    <img id="characterPortrait" class="character-portrait" src="" alt="Персонаж">

    <!-- Аудио элементы -->
    <audio id="smashSound" src="music/SmashBookvi.mp3" preload="auto"></audio>
    <audio id="menuMusic" src="music/Game menu.mp3" preload="auto" loop></audio>
    <audio id="sanctumMusic" src="music/Trickster's Sanctum (Remix).mp3" preload="auto" loop></audio>
    <audio id="trustMusic" src="music/TaintedTrust.mp3" preload="auto" loop></audio>

    <script>
        // Элементы DOM
        const actContainer = document.getElementById('actContainer');
        const letters = ['letterA', 'letterC', 'letterT', 'letter1'];
        const transitionFade = document.getElementById('transitionFade');
        const postActFade = document.getElementById('post-act-fade');
        const areaContainer = document.getElementById('areaContainer');
        const roomsLeftContainer = document.getElementById('roomsLeftContainer');
        const roomsRightContainer = document.getElementById('roomsRightContainer');
        const harlekabContainer = document.getElementById('harlekabContainer');
        const dialogueContainer = document.getElementById('dialogueContainer');
        const dialogueText = document.getElementById('dialogueText');
        const characterPortrait = document.getElementById('characterPortrait');
        const characterNameTop = document.getElementById('characterNameTop');
        const dialogueCounter = document.getElementById('dialogueCounter');
        const areaArrowUp = document.getElementById('areaArrowUp');
        
        // Стрелки
        const areaArrowLeft = document.getElementById('areaArrowLeft');
        const areaArrowRight = document.getElementById('areaArrowRight');
        const roomsLeftArrowRight = document.getElementById('roomsLeftArrowRight');
        const roomsRightArrowLeft = document.getElementById('roomsRightArrowLeft');
        const harlekabArrowRight = document.getElementById('harlekabArrowRight');
        
        // Аудио элементы
        const smashSound = document.getElementById('smashSound');
        const menuMusic = document.getElementById('menuMusic');
        const sanctumMusic = document.getElementById('sanctumMusic');
        const trustMusic = document.getElementById('trustMusic');

        // Состояние игры
        let gameState = {
            currentDialogue: [],
            currentScene: 0,
            canAdvance: true,
            isDialogActive: false,
            currentCharacter: '',
            dialogueCount: 0,
            maxDialogues: 11,
            arrowUpClicks: 0,
            arrowUpDisabled: false,
            currentLocation: 'area',
            talkedWithCharacters: new Set(),
            isInTransition: false,
            isArrowUpDialogue: false
        };

        // Фразы для стрелки вверх
        const arrowUpDialogues = [
            [
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Кажется, сейчас я не смогу туда попасть",
                    isNarrator: true,
                    effect: null
                }
            ],
            [
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Надпись «Только для персонала» висит тут явно не просто так",
                    isNarrator: true,
                    effect: null
                }
            ],
            [
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Странное место... Ощущение, что мне там не рады. Лучше не соваться",
                    isNarrator: true,
                    effect: null
                }
            ],
            [
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Кажется, дверь заперта. Идти туда нет смысла",
                    isNarrator: true,
                    effect: null
                }
            ],
            [
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Похоже, сейчас проход закрыт",
                    isNarrator: true,
                    effect: null
                }
            ]
        ];

        // Финальный скрипт для стрелки вверх
        const arrowUpFinalScript = [
            {
                background: "url('arts/area.jpg')",
                characterImage: "",
                characterName: "",
                text: "Слушай, довольно пялиться по сторонам.",
                isNarrator: true,
                effect: null
            },
            {
                background: "url('arts/area.jpg')",
                characterImage: "",
                characterName: "",
                text: "Тебе лучше заняться своим делом.",
                isNarrator: true,
                effect: null
            },
            {
                background: "url('arts/area.jpg')",
                characterImage: "",
                characterName: "",
                text: "Опроси артистов. Не трать время впустую...",
                isNarrator: true,
                effect: null
            },
            {
                background: "url('arts/area.jpg')",
                characterImage: "",
                characterName: "",
                text: "Идиот...",
                isNarrator: true,
                effect: 'glitch'
            }
        ];

        // Диалоги персонажей - с исправленными ошибками
        const dialogues = {
            "Пьеро": [
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "arts/ref.png",
                    characterName: "",
                    text: "Я неспешно подошёл к худощавому мужчине, который сидел в одиночестве на самом краю арены",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "arts/ref.png",
                    characterName: "",
                    text: "Взгляд его был устремлён в небольшое зеркальце, что стояло спереди",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "arts/ref.png",
                    characterName: "",
                    text: "Судя по всему, он отрабатывал свою речь",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "arts/ref.png",
                    characterName: "",
                    text: "Белый и печальный грим делал его образ самым привлекающим тут",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "arts/ref.png",
                    characterName: "Вы",
                    text: "Здравствуйте, я...",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "arts/ref.png",
                    characterName: "",
                    text: "Он не обернулся. Лишь надменно фыркнул и перебил меня",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "???",
                    text: "Вам здесь не место. Проваливайте",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "arts/ref.png",
                    characterName: "",
                    text: "Ответ прозвучал грубо и довольно ясно",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "arts/ref.png",
                    characterName: "",
                    text: "Но я всё же решил попробовать поговорить с ним ещё",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "arts/ref.png",
                    characterName: "Вы",
                    text: "Я фотограф, меня пригласили...",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "???",
                    text: "Он не говорил о вас ничего. А раз он ничего не сказал, то и вас здесь быть не должно",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "arts/ref.png",
                    characterName: "",
                    text: "Он перевёл усталые, практически мёртвые зрачки на меня",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "arts/ref.png",
                    characterName: "",
                    text: "Его глаза сверлили меня с такой ненавистью, что я отступил на шаг",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "???",
                    text: "И передайте тому, кто вас послал - тут нечего разнюхивать. Мы не нуждаемся в таких любопытных зрителях...",
                    isNarrator: false,
                    effect: null
                }
            ],
            "Мизери": [
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "В дальнем углу арены, где тени от прожекторов переплетались в причудливые узоры, кружилась девушка в старом костюме шута",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Её движения были порывистыми, почти хаотичными, но при этом невероятно грациозными",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Я замер на месте, наблюдая за её танцем",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "С каждым новым движением мне всё больше казалось, что я наблюдаю не за человеком, а за прекрасной птицей",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Заметив меня, танцовщица резко остановилась, словно невидимая рука дёрнула её за ниточку",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Одна нога осталась поднятой в изящной позе, а голова наклонилась в сторону с таким любопытством, какого я не видел ещё никогда",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Простояв так ещё пару секунд, она пулей бросилась ко мне, кружась вокруг, словно обнюхивая меня",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "???",
                    text: "Приветик! Что-то я не видела тебя тут раньше? Ты новенький?",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "???",
                    text: "Откуда ты? Арлекино не говорил, что собирается нанимать новых сотрудников",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "Мизери",
                    text: "Я Мизери! Приятно познакомиться!",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Она схватила меня за руку, начав без устали трясти её",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "Мизери",
                    text: "Ты ведь только пришёл, да? Значит...",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Её глаза загорелись невероятной радостью, а небольшие хрупкие ножки затопали на месте",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "Мизери",
                    text: "Ты был на улице? Чёрт, как же я тебе завидую! Я не выходила отсюда так давно...",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "Мизери",
                    text: "Как? Как там? Птицы поют? А солнце светит? А... А трава? Она всё ещё зелёная?",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "Мизери",
                    text: "Ну не молчи же!",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Она говорила так быстро, что слова сливались в один поток. От этого тайфуна информации у меня закружилась голова",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Единственное, что я смог сказать после всей волны вопросов, было:",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "arts/ref.png",
                    characterName: "Вы",
                    text: "Я... я фотограф. Меня пригласили сделать репортаж...",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "Мизери",
                    text: "Фотограф! О, как здорово! Ты будешь нас фотографировать? Меня тоже? Прошу, сделай для меня парочку красивых снимков!",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "arts/ref.png",
                    characterName: "Вы",
                    text: "Да... Да, конечно",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Лёгкая улыбка тронула мои губы. Девушка казалась очень милой, хотя и чересчур активной",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "arts/ref.png",
                    characterName: "Вы",
                    text: "Позволите задать вам пару вопросов?",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Услышав это, девушка запрыгала на месте и захлопала в ладоши",
                    isNarrator: true,
                    effect: null
                },
                 {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Отпрыгнув ближе к стенду, на котором она стояла пару минут назад, она устроилась на нём в важной позе, словно давала интервью на телевидении",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Это показалось мне довольно забавным",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Я достал блокнот, готовый записывать её ответы",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "arts/ref.png",
                    characterName: "Вы",
                    text: "Скажите, вы давно работаете здесь?",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "Мизери",
                    text: "Ой, даже не помню! Кажется, всегда. Сначала я была просто помощницей – подавала реквизит, чистила костюмы... А потом...",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Её лицо на мгновение озарила искренняя улыбка",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "Мизери",
                    text: "Меня заметили! И дали шанс...",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Она хотела было продолжить свой рассказ, но...",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Внезапно Мизери замерла. Её взгляд скользнул куда-то за мою спину, в тёмный проход между рядами. Лицо помрачнело",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "Мизери",
                    text: "Мне нужно... извини, мне нужно идти. Репетиция ещё идёт...",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Она отступила на шаг, потом на другой",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "Мизери",
                    text: "Поговорим позже, ладно? Когда... когда будет время. Я покажу тебе тут всё. Обещаю",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Не дожидаясь ответа, она развернулась и почти побежала в сторону гримёрки",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Я обернулся назад, пытаясь понять, что могло так сильно напугать её",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "В тёмном проходе мелькнула высокая фигура. Она посмотрела на меня из тени пару секунд, а затем двинулась дальше, скрывшись в правом крыле цирка",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Не придав этому значения, я вновь повернулся в сторону своей новой знакомой",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Но Мизери поблизости уже не было",
                    isNarrator: true,
                    effect: null
                }
            ],
            "Ригар": [
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "В самом центре арены стоял мужчина, чьи размеры заставляли сомневаться в реальности происходящего вокруг",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Его плечи были шире, чем дверной проём, а мышцы на руках напоминали переплетённые канаты",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "В кистях он держал по гире, каждая из которых весила явно не меньше центнера",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Силач вращал их в воздухе с такой лёгкостью, словно это шарики для пинг-понга, создавая низкий гул, от которого дребезжали металлические конструкции под куполом",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "С каждым взмахом мышцы на его спине напрягались, образуя рельеф, достойный античной статуи",
                    isNarrator: true,
                    effect: null
                },

                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Засмотревшись на это, я совершенно забыл про технику безопасности",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Нервно сжимая в руках камеру, я медленно двинулся к атлету, намереваясь во что бы то ни стало взять у него интервью",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Внезапно одна из гирь соскользнула с его ладони. Металлический шар, вращаясь в воздухе, полетел прямо в мою сторону и...",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "БАХ!",
                    isNarrator: true,
                    effect: 'earthquake-strong'
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Я отскочил назад, прикрывая глаза от страха",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Гиря вонзилась в деревянный настил в каких-то десяти сантиметрах от моей ноги",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Древесина треснула с таким звуком, будто под ареной взорвалась петарда. Щепки разлетелись во все стороны",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "???",
                    text: "Чёрт побери! Прости, дружище, не заметил!",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Его голос был низким и очень мужественным. Он поставил вторую гирю на пол и огромными шагами приблизился ко мне",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "arts/ref.png",
                    characterName: "Вы",
                    text: "Я... я в порядке... кажется...",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Он наклонился, и я впервые увидел его лицо вблизи. Несмотря на исполинские размеры, черты его были удивительно приятными и добрыми",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "???",
                    text: "Позволь",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Одной рукой – рукой, которая была размером с мою голову – он выдернул гирю из пола, будто это была детская игрушка. Древесина скрипнула, выпуская металлический шар",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "???",
                    text: "Тут не место для прогулок, дружище. Ты понимаешь, что могло бы случиться?",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "arts/ref.png",
                    characterName: "Вы",
                    text: "Простите... Я просто хотел познакомиться... я фотограф...",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "???",
                    text: "Фотограф значит?",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Громила поставил гирю рядом, скрестив руки на груди",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "arts/ref.png",
                    characterName: "Вы",
                    text: "Я хочу показать настоящую работу цирка... тяжёлый труд...",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "???",
                    text: "Ты сейчас видел кусочек. Но это только разминка",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Он развернулся, подошёл к стене, где висели цепи, и снял одну из них. Звенья были толщиной с мой палец",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "???",
                    text: "Смотри фокус",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Схватив цепь покрепче, он, пыхтя как паровоз, разорвал одно из звеньев и свернул его в небольшой калач",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Я восхищённо достал камеру и сделал быстрый снимок",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "arts/ref.png",
                    characterName: "Вы",
                    text: "Это... впечатляет",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Он бросил цепь обратно на крюк. Звенья зазвенели, как погребальный колокольчик",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Вернувшись ко мне, он заглянул в фотоаппарат",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "???",
                    text: "Отличное фото. Отправишь мне его потом?",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Я одобрительно кивнул",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Силач вновь поднял свою гирю и вернулся на исходную позицию",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "???",
                    text: "Познакомиться успеешь на представлении. Сейчас же – прошу, освободи арену. Это для твоей же безопасности",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Он кивнул в сторону выхода. Его улыбка была доброй, почти отеческой",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Артист добродушно похлопал меня по плечу так, что я чуть не вдавился в пол",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Я попрощался и пошёл дальше, не желая больше мешать атлету",
                    isNarrator: true,
                    effect: null
                }
            ],
            "Каррус": [
            {
                background: "url('arts/area.jpg')",
                characterImage: "",
                characterName: "",
                text: "В дальнем углу арены, где обычно ставят громоздкие реквизиты, я заметил молодого человека",
                isNarrator: true,
                effect: null
            },
            {
                background: "url('arts/area.jpg')",
                characterImage: "",
                characterName: "",
                text: "Он стоял спиной ко мне, поправляя бордовый пиджак с золотой отделкой. Седовато-русые волосы на его голове выглядели нарочито небрежными",
                isNarrator: true,
                effect: null
            },
            {
                background: "url('arts/area.jpg')",
                characterImage: "",
                characterName: "",
                text: "Парень что-то говорил тихим, успокаивающим голосом, обращаясь к... пустому пространству перед собой",
                isNarrator: true,
                effect: null
            },
            {
                background: "url('arts/area.jpg')",
                characterImage: "",
                characterName: "",
                text: "На его голове красовалась шляпа с пером, а глаза скрывала позолоченно-чёрная маска",
                isNarrator: true,
                effect: null
            },
            {
                background: "url('arts/area2.jpg')",
                characterImage: "",
                characterName: "",
                text: "Я осторожно приблизился, стараясь не нарушить странный ритуал",
                isNarrator: true,
                effect: null
            },
            {
                background: "url('arts/area2.jpg')",
                characterImage: "",
                characterName: "",
                text: "Заметив меня, он обернулся. Улыбка, появившаяся на его лице, казалась вполне искренней",
                isNarrator: true,
                effect: null
            },
            {
                background: "url('arts/area2.jpg')",
                characterImage: "",
                characterName: "???",
                text: "А, посетитель! Приветствую. Извини, что не заметил тебя сразу. Я успокаивал своих питомцев",
                isNarrator: false,
                effect: null
            },
            {
                background: "url('arts/area2.jpg')",
                characterImage: "arts/ref.png",
                characterName: "Вы",
                text: "Питомцев? Но ведь здесь...",
                isNarrator: false,
                effect: null
            },
            {
                background: "url('arts/area2.jpg')",
                characterImage: "",
                characterName: "",
                text: "Парнишка добродушно усмехнулся",
                isNarrator: true,
                effect: null
            },
            {
                background: "url('arts/area2.jpg')",
                characterImage: "",
                characterName: "",
                text: "Признаться честно, он выглядел самым молодым тут",
                isNarrator: true,
                effect: null
            },
            {
                background: "url('arts/area2.jpg')",
                characterImage: "",
                characterName: "???",
                text: "Ах да, ты не видишь их",
                isNarrator: false,
                effect: null
            },
            {
                background: "url('arts/area2.jpg')",
                characterImage: "",
                characterName: "???",
                text: "Понимаешь, я — дрессировщик невидимых животных. Звучит как шутка, но это так",
                isNarrator: false,
                effect: null
            },
            {
                background: "url('arts/area2.jpg')",
                characterImage: "arts/ref.png",
                characterName: "Вы",
                text: "Вы серьёзно?",
                isNarrator: false,
                effect: null
            },
            {
                background: "url('arts/area.jpg')",
                characterImage: "",
                characterName: "",
                text: "Я не мог скрыть лёгкого скепсиса. Дрессировщик невидимых животных? Похоже на дешёвый трюк для привлечения внимания.",
                isNarrator: true,
                effect: null
            },
            {
                background: "url('arts/area2.jpg')",
                characterImage: "",
                characterName: "???",
                text: "Вполне серьёзно",
                isNarrator: false,
                effect: null
            },
            {
                background: "url('arts/area2.jpg')",
                characterImage: "",
                characterName: "",
                text: "Он провел ладонью по воздуху, словно поглаживая кого-то",
                isNarrator: true,
                effect: null
            },
            {
                background: "url('arts/area2.jpg')",
                characterImage: "",
                characterName: "???",
                text: "Знакомься, это Амур - белый тигр. Правда, он красивый?",
                isNarrator: false,
                effect: null
            },
            {
                background: "url('arts/area2.jpg')",
                characterImage: "arts/ref.png",
                characterName: "Вы",
                text: "Я... не вижу никакого тигра",
                isNarrator: false,
                effect: null
            },
            {
                background: "url('arts/area2.jpg')",
                characterImage: "",
                characterName: "???",
                text: "Именно поэтому он и идеален для цирка. Никаких клеток, никакого страха у зрителей... только чистое искусство",
                isNarrator: false,
                effect: null
            },
            {
                background: "url('arts/area.jpg')",
                characterImage: "",
                characterName: "",
                text: "Он вновь погладил воздух перед собой, словно там действительно было огромное животное",
                isNarrator: true,
                effect: null
            },
            {
                background: "url('arts/area2.jpg')",
                characterImage: "",
                characterName: "???",
                text: "Я работаю с ними уже года два. Сначала было... сложно. Как дрессировать то, что не видишь?",
                isNarrator: false,
                effect: null
            },
            {
                background: "url('arts/area2.jpg')",
                characterImage: "",
                characterName: "???",
                text: "Но потом я понял — главное не видеть, а чувствовать. Их дыхание, их настроение, их... присутствие",
                isNarrator: false,
                effect: null
            },
            {
                background: "url('arts/area2.jpg')",
                characterImage: "",
                characterName: "???",
                text: "Понимаешь?",
                isNarrator: false,
                effect: null
            },
            {
                background: "url('arts/area2.jpg')",
                characterImage: "",
                characterName: "",
                text: "Сказать честно, я не понимал... Но сообщить об этом дрессировщику не рискнул",
                isNarrator: false,
                effect: null
            },
            {
                    background: "url('arts/area2.jpg')",
                characterImage: "arts/ref.png",
                characterName: "Вы",
                text: "И они... прямо сейчас здесь?",
                isNarrator: false,
                effect: null
            },
            {
                background: "url('arts/area2.jpg')",
                characterImage: "",
                characterName: "???",
                text: "Да. Не бойся, погладь их",
                isNarrator: false,
                effect: null
            },
            {
                background: "url('arts/area.jpg')",
                characterImage: "",
                characterName: "",
                text: "Внезапно из пустоты донёсся низкий, едва уловимый рык. Мурашки побежали у меня по спине",
                isNarrator: true,
                effect: null
            },
            {
                background: "url('arts/area2.jpg')",
                characterImage: "arts/ref.png",
                characterName: "Вы",
                text: "Это...",
                isNarrator: false,
                effect: null
            },
            {
                background: "url('arts/area2.jpg')",
                characterImage: "",
                characterName: "???",
                text: "Вот чёрт...",
                isNarrator: false,
                effect: null
            },
            {
                background: "url('arts/area.jpg')",
                characterImage: "",
                characterName: "",
                text: "Лицо дрессировщика внезапно стало серьёзным. Он провёл рукой по воздуху, словно успокаивая невидимое животное",
                isNarrator: true,
                effect: null
            },
            {
                background: "url('arts/area2.jpg')",
                characterImage: "",
                characterName: "???",
                text: "Прости... тебе лучше уйти. Я только смог их успокоить, а твоё присутствие...",
                isNarrator: false,
                effect: null
            },
            {
                background: "url('arts/area2.jpg')",
                characterImage: "",
                characterName: "???",
                text: "В общем, они не особо любят чужаков...",
                isNarrator: false,
                effect: null
            },
            {
                background: "url('arts/area2.jpg')",
                characterImage: "",
                characterName: "???",
                text: "Невидимые — не значит безопасные. У них тоже есть инстинкты",
                isNarrator: false,
                effect: null
            },
            {
                background: "url('arts/area2.jpg')",
                characterImage: "arts/ref.png",
                characterName: "Вы",
                text: "Я понимаю... Позвольте последний вопрос, как вас зовут?",
                isNarrator: false,
                effect: null
            },
            {
                background: "url('arts/area2.jpg')",
                characterImage: "",
                characterName: "Каррус",
                text: "Каррус. Меня зовут Каррус",
                isNarrator: false,
                effect: null
            },
            {
                background: "url('arts/area.jpg')",
                characterImage: "",
                characterName: "",
                text: "Он снова улыбнулся, но в его глазах читалась лёгкая тревога",
                isNarrator: true,
                effect: null
            },
            {
                background: "url('arts/area2.jpg')",
                characterImage: "",
                characterName: "Каррус",
                text: "Загляни на представление — тогда увидишь, на что они способны. Ну... в смысле, не увидишь, но поймёшь",
                isNarrator: false,
                effect: null
            },
            {
                background: "url('arts/area.jpg')",
                characterImage: "",
                characterName: "",
                text: "Я немного усмехнулся с этой фразы",
                isNarrator: true,
                effect: null
            },
            {
                background: "url('arts/area.jpg')",
                characterImage: "",
                characterName: "",
                text: "Попрощавшись с дрессировщиком, я ушёл прочь, не рискуя тревожить его зверей больше",
                isNarrator: true,
                effect: null
            },
            {
                background: "url('arts/area.jpg')",
                characterImage: "",
                characterName: "",
                text: "Кто знает, может парень и не блефует...",
                isNarrator: true,
                effect: null
            }
        ],
            "Гутта": [
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "В самом тихом углу арены, там, где света почти не было, сидел ещё один человек",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Он не двигался. Казалось, даже не дышал. Длинные волосы, собранные резинкой, лежали на его оголённой спине",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "На его худощавом теле выделялись татуировки — странные облака, закрученные в спирали",
                    isNarrator: true,
                    effect: null
                },
                 {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Их значение не было мне известно",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Но больше всего привлекала катана, лежавшая перед ним на полу",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Острый инструмент с оголённым лезвием делал мужчину похожим на самурая",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Я замер на месте, не решаясь нарушить эту медитативную тишину",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Человек поднял голову. Его лицо было лишено возраста — ни молодое, ни старое. Просто... лицо",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "???",
                    text: "Ты прервал тишину. Семь минут и сорок три секунды",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "arts/ref.png",
                    characterName: "Вы",
                    text: "Извините... я не хотел...",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "???",
                    text: "Теперь нужно начинать с начала",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Он вздохнул — звук был похож на шум ветра в пустой пещере",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "???",
                    text: "Что тебе нужно?",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "arts/ref.png",
                    characterName: "Вы",
                    text: "Я фотограф. Делаю репортаж о цирке. Вы... самурай?",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "???",
                    text: "Самурай? Нет",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "???",
                    text: "Кому интересен самурай в цирке?",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "Гутта",
                    text: "Моё имя Куродо Гутта. Здесь я работаю в качестве глотателя шпаг",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "arts/ref.png",
                    characterName: "Вы",
                    text: "Глотатель... но это же катана?",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "Гутта",
                    text: "Это — клинок длиной девяносто три сантиметра. Вес — девятьсот граммов. Сталь — тамахаганэ",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "Гутта",
                    text: "Думаешь, пластиковые шпаги лучше, чем моё оружие?",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Он произнёс это спокойно, но с явной ноткой вызова в голосе",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "arts/ref.png",
                    characterName: "Вы",
                    text: "Хотите сказать, что вы глотаете это?",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "arts/ref.png",
                    characterName: "Вы",
                    text: "Это... невозможно. Человеческое тело...",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Гутта резко нахмурил брови. Он выглядел немного оскорблённым",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "Гутта",
                    text: "Не может позволить проглотить острое лезвие без вреда для себя?",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "Гутта",
                    text: "Тело — это лишь граница в нашем сознании. А границы — не что иное, как иллюзия",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Он медленно поднял катану. Движение было плавным, почти церемониальным",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "Гутта",
                    text: "Видишь этот клинок? Он острый. Он режет. Он убивает",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterName: "Гутта",
                    text: "Но что такое острота? Ощущение. Что такое резка? Разделение. Что такое смерть?.. Просто ещё одна граница",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Он поднёс конец катаны ко рту. Моё сердце забилось чаще",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Плавным движением он опускал клинок себе в горло всё ниже и ниже",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Через пару мгновений на виду осталась лишь рукоять",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Я в восхищении замер напротив, достал камеру и сделал пару снимков мастера в исполнении",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Позволив мне запечатлеть удачный кадр, Гутта извлёк меч обратно, вытирая его о салфетку и опуская на специально отведённое покрывало",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterName: "Гутта",
                    text: "Убедился? Это не так сложно, как кажется",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterName: "Гутта",
                    text: "Но для обучения такому делу нужна тишина. А ты своим присутствием явно нарушил её",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "arts/ref.png",
                    characterName: "Вы",
                    text: "Мне... лучше уйти?",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "Гутта",
                    text: "Это было бы кстати",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Его глаза снова стали пустыми",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Подобно монаху-отшельнику он опустился на пол, входя в медитативный транс",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Разговор явно был окончен",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Я отступил, стараясь не издавать ни звука. Но в последний момент моя нога случайно задела металлическую деталь на полу",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Всё вокруг зазвенело",
                    isNarrator: true,
                    effect: 'earthquake-text'
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "Гутта",
                    text: "Двенадцать секунд...",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Извинившись за неаккуратность, я ушёл, оставив артиста считать тишину снова",
                    isNarrator: true,
                    effect: null
                }
            ],
            "Фата Моргана": [
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Вскоре моё внимание привлекли две девушки, что кружились, взявшись за руки",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Они двигались с абсолютной синхронностью — как будто одна душа управляла двумя телами сразу",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Их костюмы были инверсией друг друга: одна в синем с серыми акцентами, другая — в сером с синими",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Но самое странное — их волосы. Они были сплетены вместе в единую косу, которая связывала их даже на расстоянии",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Заметив меня, они одновременно спрыгнули с трапеции",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Их движения были зеркальными — когда одна поднимала правую руку, другая поднимала левую",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Обе быстро приблизились, улыбаясь одинаковыми улыбками",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "???",
                    text: "Новенький",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Они сказали это одновременно, но голос звучал как один",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "arts/ref.png",
                    characterName: "Вы",
                    text: "Здравствуйте... Я... фотограф...",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "???",
                    text: "Ах, фотограф",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "???",
                    text: "Как мило",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "arts/ref.png",
                    characterName: "Вы",
                    text: "Вы... говорите вместе",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "???",
                    text: "Мы говорим как хотим",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "???",
                    text: "Потому что это удобно",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Теперь они говорили поочерёдно, но продолжали заканчивать мысли друг друга",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "???",
                    text: "Наше имя Фата Моргана",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "arts/ref.png",
                    characterName: "Вы",
                    text: "Приятно познакомиться...",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "Фата Моргана",
                    text: "А как тебя зовут",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "arts/ref.png",
                    characterName: "Вы",
                    text: "Я?...",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "arts/ref.png",
                    characterName: "Вы",
                    text: "Меня зовут Алекс...",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "Фата Моргана",
                    text: "Алекс...",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "Фата Моргана",
                    text: "Какое красивое имя",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Они снова сказали это вместе. Их улыбки стали чуть шире",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "Фата Моргана",
                    text: "Ты такой серьёзный, Алекс",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "Фата Моргана",
                    text: "Цирк — это место для веселья",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Одна из них подошла ближе. Другая повторила за ней",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "Фата Моргана",
                    text: "Ты ведь останешься на представление",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "Фата Моргана",
                    text: "Мы покажем тебе кое-что особенное",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "arts/ref.png",
                    characterName: "Вы",
                    text: "Мне нужно сделать интервью... Опросить других артистов...",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Когда я сделал шаг назад, их лица одновременно изменились — выражение стало немного грустным",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "Фата Моргана",
                    text: "Уже уходишь?",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "Фата Моргана",
                    text: "Мы только познакомились",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Прежде чем я успел ответить, они одновременно обняли меня",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Это было странное ощущение — две пары рук, два тела, но одно движение",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "Фата Моргана",
                    text: "Останься с нами ещё на немного, Алекс",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "Фата Моргана",
                    text: "Мы поможем тебе снять интервью",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Их голоса стали тише, почти шёпотом, но по-прежнему звучали в унисон",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "Фата Моргана",
                    text: "Останься",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Они отпустили меня одновременно",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "И отступили на шаг, всё ещё улыбаясь",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Затем ушли прочь, оставив меня в лёгком шоке от происходящего",
                    isNarrator: true,
                    effect: null
                }
            ],
            "Калиостро": [
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Возле южной колонны арены стоял небольшой стол, покрытый тёмно-бордовой тканью",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "На нём лежали странные предметы: хрустальный шар, разложенные карты Таро и несколько свечей в старинных подсвечниках",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "За столом сидела женщина. Её длинные тёмные волосы были расплетены и мягко лежали на плечах и спине",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "На её лице была лёгкая дымка таинственности, а глаза были полуприкрыты, словно она видела что-то за пределами реальности",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Когда я приблизился, она медленно подняла взгляд. Её глаза были цвета старого янтаря — тёплые, глубокие и невероятно проницательные",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "arts/КалиостроАкт1.png",
                    characterName: "???",
                    text: "Ты пришёл за ответами...",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "arts/ref.png",
                    characterName: "Вы",
                    text: "Простите? Я просто...",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "arts/КалиостроАкт1.png",
                    characterName: "???",
                    text: "Не нужно извиняться. Карты уже рассказали мне о тебе",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Она провела рукой над колодой, словно что-то спрашивая у них",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "arts/КалиостроАкт1.png",
                    characterName: "???",
                    text: "Ты ищешь правду. Но боишься её найти",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "arts/ref.png",
                    characterName: "Вы",
                    text: "Мне... Мне просто нужно сделать репортаж",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Женщина тихо рассмеялась. Её смех отразился эхом по всему шатру",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "arts/КалиостроАкт1.png",
                    characterName: "???",
                    text: "Фотограф...",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "arts/КалиостроАкт1.png",
                    characterName: "Калиостро",
                    text: "Меня зовут Калиостро. Я предсказательница судеб этого цирка",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "arts/ref.png",
                    characterName: "Вы",
                    text: "Вы... действительно видите будущее?",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Она взяла хрустальный шар в руки. Внутри него заклубился лёгкий туман",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "arts/КалиостроАкт1.png",
                    characterName: "Калиостро",
                    text: "Будущее — это не прямая дорога. Это множество тропинок в тумане. Одни ведут к свету, другие — глубоко во тьму",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "arts/КалиостроАкт1.png",
                    characterName: "Калиостро",
                    text: "Цирк сейчас стоит на распутье... Тебе не стоит тут задерживаться...",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "arts/ref.png",
                    characterName: "Вы",
                    text: "Что вы имеете в виду?",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Девушка замолчала, словно и сама не знала, что ответить на этот вопрос",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "arts/КалиостроАкт1.png",
                    characterName: "Калиостро",
                    text: "Сейчас не лучшее время для расспросов. Он не особо жалует чужаков...",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "arts/КалиостроАкт1.png",
                    characterName: "Калиостро",
                    text: "Постарайся не попадаться ему на глаза, пока он не решит свои проблемы...",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "arts/КалиостроАкт1.png",
                    characterName: "Калиостро",
                    text: "Но главное помни...",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Калиостро протянула руку и коснулась моего запястья. Её пальцы были холодными, как мрамор",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "На мгновение мне показалось, что по коже пробежали мурашки",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "arts/КалиостроАкт1.png",
                    characterName: "Калиостро",
                    text: "У тебя сильная аура. Ты видишь то, что другие предпочитают не замечать...",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "arts/КалиостроАкт1.png",
                    characterName: "Калиостро",
                    text: "Будь осторожен со своим даром. Правда иногда бывает... опасной",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Она отпустила мою руку и взяла одну из карт с колоды",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "На ней было изображено колесо фортуны",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "arts/КалиостроАкт1.png",
                    characterName: "Калиостро",
                    text: "Если тебя не выгонят, загляни как-нибудь. Я сделаю для тебя расклад",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "arts/КалиостроАкт1.png",
                    characterName: "Калиостро",
                    text: "Может быть, тогда ты поймёшь, зачем судьба привела тебя сюда",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "arts/ref.png",
                    characterName: "Вы",
                    text: "Спасибо... Я подумаю",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Калиостро снова погрузилась в созерцание хрустального шара",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Её губы шептали что-то неслышное, а в глазах отражались странные узоры тумана",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Я осторожно отошёл, оставив предсказательницу наедине с её видениями",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Но её слова продолжали звучать у меня в голове, как далёкое эхо",
                    isNarrator: true,
                    effect: null
                }
            ],
            "Пульсио": [
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Возле одной из дверей сидел мужчина в потёртом костюме",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "На коленях у него лежала старая шарманка с потрескавшимся лаком и тусклыми латунными деталями",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Его пальцы медленно вращали ручку. Простенькая мелодия тихо лилась из механизма",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "На его лице застыло выражение холодного равнодушия",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Я осторожно приблизился, стараясь не нарушить его уединение",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Он не поднял глаз, продолжая смотреть на свои руки",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "arts/ПульсиоАкт1.png",
                    characterName: "???",
                    text: "Вам здесь не место",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "arts/ref.png",
                    characterName: "Вы",
                    text: "Я фотограф, меня прислали сделать репортаж",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Он наконец поднял голову. Его холодные и безжизненные глаза сверлили меня изнутри",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "arts/ПульсиоАкт1.png",
                    characterName: "???",
                    text: "Здесь вас никто не ждёт",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "arts/ПульсиоАкт1.png",
                    characterName: "???",
                    text: "Уходите, пока можете",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "arts/ref.png",
                    characterName: "Вы",
                    text: "Но мне нужно задать несколько вопросов...",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Он резко встал. Шарманка на его руке заскрипела громче",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "arts/ПульсиоАкт1.png",
                    characterName: "???",
                    text: "Я обращусь к руководству",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "arts/ПульсиоАкт1.png",
                    characterName: "???",
                    text: "Если вы не уйдёте сейчас",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "arts/ref.png",
                    characterName: "Вы",
                    text: "Просто пара вопросов о вашей работе...",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "arts/ПульсиоАкт1.png",
                    characterName: "???",
                    text: "Я повторю в последний раз",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "arts/ПульсиоАкт1.png",
                    characterName: "???",
                    text: "Я не желаю видеть вас больше",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Он повернулся и ушёл в сторону задней сцены, не оглядываясь",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Скрип его шарманки ещё долго эхом отдавался в пустом пространстве",
                    isNarrator: true,
                    effect: null
                }
            ],
            "Китагава": [
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Прохаживаясь по арене, я сначала даже не заметил молодого человека, скрючившегося недалеко от входа",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Он сидел прямо на полу, склонившись над скрипкой, словно молясь ей",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Его растрёпанные волосы падали на лицо, скрывая выражение глаз",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Смычок в его руках двигался почти беззвучно — лишь тихие, печальные ноты разливались в тишине",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Я остановился на расстоянии, не решаясь прервать эту грустную мелодию",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Вскоре он закончил игру и опустил смычок, но так и не поднял глаз",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "arts/ref.png",
                    characterName: "Вы",
                    text: "Вы прекрасно играете",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Молодой человек медленно поднял голову. Его глаза были полны гнетущей печали",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "arts/КитагаваАкт1.png",
                    characterName: "???",
                    text: "Спасибо",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Он сказал это так тихо, что слова почти потерялись в тишине",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "arts/ref.png",
                    characterName: "Вы",
                    text: "Вы музыкант цирка?",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "arts/КитагаваАкт1.png",
                    characterName: "???",
                    text: "Да",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Он снова опустил взгляд на скрипку, поглаживая её гриф",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "arts/ref.png",
                    characterName: "Вы",
                    text: "Долго здесь работаете?",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Молодой человек провёл пальцем по струнам, извлекая тихий звук",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "arts/КитагаваАкт1.png",
                    characterName: "Китагава",
                    text: "Достаточно",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "В его голосе не было ни злости, ни раздражения — только усталая покорность",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "arts/ref.png",
                    characterName: "Вы",
                    text: "Вам... грустно?",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "arts/КитагаваАкт1.png",
                    characterName: "???",
                    text: "Музыка всегда грустна. Такова её суть... Такова её прелесть...",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Он снова взял смычок и коснулся им струн",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area2.jpg')",
                    characterImage: "arts/КитагаваАкт1.png",
                    characterName: "???",
                    text: "Извините, мне нужно тренироваться",
                    isNarrator: false,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "И снова начал играть ту же печальную мелодию, что и раньше",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Разговор явно был окончен",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Я постоял ещё мгновение, слушая его игру, а затем тихо отошёл",
                    isNarrator: true,
                    effect: null
                },
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Грустные ноты провожали меня, пока я не скрылся в другом конце арены",
                    isNarrator: true,
                    effect: null
                }
            ],
            "Лоскут": [
    {
        background: "url('arts/area.jpg')",
        characterImage: "",
        characterName: "",
        text: "Затем я наткнулся на ещё одну фигуру. Пожалуй, самого старого человека, которого я видел в цирке",
        isNarrator: true,
        effect: null
    },
    {
        background: "url('arts/area.jpg')",
        characterImage: "",
        characterName: "",
        text: "Его спина была сгорблена годами, а руки, покрытые паутиной морщин, держали портновский метр",
        isNarrator: true,
        effect: null
    },
    {
        background: "url('arts/area.jpg')",
        characterImage: "",
        characterName: "",
        text: "Перед ним на манекене висел странный костюм — пёстрый, с нашитыми лоскутами и блёстками",
        isNarrator: true,
        effect: null
    },
    {
        background: "url('arts/area.jpg')",
        characterImage: "",
        characterName: "",
        text: "Старик что-то бормотал себе под нос, делая замеры и отмечая места для подшивки",
        isNarrator: true,
        effect: null
    },
    {
        background: "url('arts/area2.jpg')",
        characterImage: "",
        characterName: "",
        text: "Я осторожно приблизился и позвал его",
        isNarrator: true,
        effect: null
    },
    {
        background: "url('arts/area2.jpg')",
        characterImage: "arts/ref.png",
        characterName: "Вы",
        text: "Здравствуйте",
        isNarrator: false,
        effect: null
    },
    {
        background: "url('arts/area.jpg')",
        characterImage: "",
        characterName: "",
        text: "Старик не обернулся, продолжая своё дело",
        isNarrator: true,
        effect: null
    },
    {
        background: "url('arts/area2.jpg')",
        characterImage: "arts/ref.png",
        characterName: "Вы",
        text: "Здравствуйте!",
        isNarrator: false,
        effect: null
    },
    {
        background: "url('arts/area.jpg')",
        characterImage: "",
        characterName: "",
        text: "Я сказал громче. Старик медленно повернул голову",
        isNarrator: true,
        effect: null
    },
    {
        background: "url('arts/area2.jpg')",
        characterImage: "arts/ЛоскутАкт1.png",
        characterName: "???",
        text: "Ммм?",
        isNarrator: false,
        effect: null
    },
    {
        background: "url('arts/area2.jpg')",
        characterImage: "arts/ref.png",
        characterName: "Вы",
        text: "Я фотограф!",
        isNarrator: false,
        effect: null
    },
    {
        background: "url('arts/area2.jpg')",
        characterImage: "arts/ЛоскутАкт1.png",
        characterName: "???",
        text: "Что?",
        isNarrator: false,
        effect: null
    },
    {
        background: "url('arts/area.jpg')",
        characterImage: "",
        characterName: "",
        text: "Он приложил ладонь к уху, нахмурив седые брови",
        isNarrator: true,
        effect: null
    },
    {
        background: "url('arts/area2.jpg')",
        characterImage: "arts/ref.png",
        characterName: "Вы",
        text: "ФОТОГРАФ! ДЕЛАЮ РЕПОРТАЖ!",
        isNarrator: false,
        effect: null
    },
    {
        background: "url('arts/area.jpg')",
        characterImage: "",
        characterName: "",
        text: "Старик отпрянул, морщась",
        isNarrator: true,
        effect: null
    },
    {
        background: "url('arts/area2.jpg')",
        characterImage: "arts/ЛоскутАкт1.png",
        characterName: "???",
        text: "Молодой человек, не стоит так орать, я не глухой",
        isNarrator: false,
        effect: null
    },
    {
        background: "url('arts/area2.jpg')",
        characterImage: "arts/ЛоскутАкт1.png",
        characterName: "Лоскут",
        text: "Просто старый",
        isNarrator: false,
        effect: null
    },
    {
        background: "url('arts/area2.jpg')",
        characterImage: "arts/ref.png",
        characterName: "Вы",
        text: "Извините... Можно задать вам пару вопросов?",
        isNarrator: false,
        effect: null
    },
    {
        background: "url('arts/area2.jpg')",
        characterImage: "arts/ЛоскутАкт1.png",
        characterName: "Лоскут",
        text: "Ммм?",
        isNarrator: false,
        effect: null
    },
    {
        background: "url('arts/area.jpg')",
        characterImage: "",
        characterName: "",
        text: "Он снова приложил руку к уху, но на этот раз его взгляд стал хмурым",
        isNarrator: true,
        effect: null
    },
    {
        background: "url('arts/area2.jpg')",
        characterImage: "arts/ЛоскутАкт1.png",
        characterName: "Лоскут",
        text: "Ты отвлекаешь",
        isNarrator: false,
        effect: null
    },
    {
        background: "url('arts/area2.jpg')",
        characterImage: "arts/ЛоскутАкт1.png",
        characterName: "Лоскут",
        text: "Мне надо работать",
        isNarrator: false,
        effect: null
    },
    {
        background: "url('arts/area.jpg')",
        characterImage: "",
        characterName: "",
        text: "Он повернулся обратно к манекену, взяв в руки иголку с ниткой",
        isNarrator: true,
        effect: null
    },
    {
        background: "url('arts/area.jpg')",
        characterImage: "",
        characterName: "",
        text: "Его пальцы, несмотря на возраст, двигались удивительно ловко и уверенно",
        isNarrator: true,
        effect: null
    },
    {
        background: "url('arts/area.jpg')",
        characterImage: "",
        characterName: "",
        text: "Я понял, что дальнейшие попытки разговора бесполезны",
        isNarrator: true,
        effect: null
    },
    {
        background: "url('arts/area.jpg')",
        characterImage: "",
        characterName: "",
        text: "Старик полностью погрузился в свою работу, словно забыв о моём существовании",
        isNarrator: true,
        effect: null
    },
    {
        background: "url('arts/area.jpg')",
        characterImage: "",
        characterName: "",
        text: "Лишь тихое бормотание и скрип иглы сопровождали его движения",
        isNarrator: true,
        effect: null
    }
],
            "Фуфу": [
                {
                    background: "url('arts/area.jpg')",
                    characterImage: "",
                    characterName: "",
                    text: "Временно недоступно",
                    isNarrator: true,
                    effect: null
                },
            ],
            "Арлекино": [
    {
        background: "url('arts/Harlekab.jpg')",
        characterImage: "",
        characterName: "",
        text: "Дверь в кабинет была приоткрыта. Из-за неё доносился гневный голос",
        isNarrator: true,
        effect: null
    },
    {
        background: "url('arts/Harlekab.jpg')",
        characterImage: "",
        characterName: "???",
        text: "Я не понимаю, КАК можно просто исчезнуть! Нет, не \"раствориться в воздухе\", а исчезнуть физически!",
        isNarrator: false,
        effect: null
    },
    {
        background: "url('arts/Harlekab.jpg')",
        characterImage: "",
        characterName: "",
        text: "Затем была долгая пауза. Было слышно тяжёлое дыхание говорящего",
        isNarrator: true,
        effect: null
    },
    {
        background: "url('arts/Harlekab.jpg')",
        characterImage: "",
        characterName: "???",
        text: "Она знала правила. Никто не уходит без моего разрешения. Особенно сейчас, когда мы готовимся к важному представлению",
        isNarrator: false,
        effect: null
    },
    {
        background: "url('arts/Harlekab.jpg')",
        characterImage: "",
        characterName: "",
        text: "Затем вновь молчание. Человек слушал ответчика в телефоне",
        isNarrator: true,
        effect: null
    },
    {
        background: "url('arts/Harlekab.jpg')",
        characterImage: "",
        characterName: "???",
        text: "Хорошо... Да, я постараюсь что-то придумать... Всего доброго",
        isNarrator: false,
        effect: null
    },
    {
        background: "url('arts/Harlekab.jpg')",
        characterImage: "",
        characterName: "",
        text: "Мужчина в маске с яростью бросил трубку старого телефона обратно на место",
        isNarrator: true,
        effect: 'glitch'
    },
    {
        background: "url('arts/Harlekab.jpg')",
        characterImage: "",
        characterName: "",
        text: "Я осторожно постучал и вошёл. За массивным столом сидел арлекин в пёстром костюме. На его лице была одета белоснежная фарфоровая маска",
        isNarrator: true,
        effect: null
    },
    {
        background: "url('arts/Harlekab.jpg')",
        characterImage: "arts/HarlequinoACT1.png",
        characterName: "???",
        text: "М? Кто здесь?",
        isNarrator: false,
        effect: null
    },
    {
        background: "url('arts/Harlekab.jpg')",
        characterImage: "arts/ref.png",
        characterName: "Вы",
        text: "Здравствуйте. Я...",
        isNarrator: false,
        effect: null
    },
    {
        background: "url('arts/Harlekab.jpg')",
        characterImage: "",
        characterName: "",
        text: "Арлекин быстро перебил меня, вскакивая с места",
        isNarrator: true,
        effect: null
    },
    {
        background: "url('arts/Harlekab.jpg')",
        characterImage: "arts/HarlequinoACT1.png",
        characterName: "???",
        text: "Новый артист? О, хвала небесам... Довольно быстро нашёлся. Умеешь ходить по канату?",
        isNarrator: false,
        effect: null
    },
    {
        background: "url('arts/Harlekab.jpg')",
        characterImage: "arts/ref.png",
        characterName: "Вы",
        text: "Нет, я...",
        isNarrator: false,
        effect: null
    },
    {
        background: "url('arts/Harlekab.jpg')",
        characterImage: "arts/HarlequinoACT1.png",
        characterName: "???",
        text: "Жаль. А жонглировать? С огнём? Может прыгать в кольца?",
        isNarrator: false,
        effect: null
    },
    {
        background: "url('arts/Harlekab.jpg')",
        characterImage: "",
        characterName: "",
        text: "Я вновь отрицательно покачал головой",
        isNarrator: true,
        effect: null
    },
    {
        background: "url('arts/Harlekab.jpg')",
        characterImage: "arts/HarlequinoACT1.png",
        characterName: "???",
        text: "Нет? Бесполезность...",
        isNarrator: false,
        effect: null
    },
    {
        background: "url('arts/Harlekab.jpg')",
        characterImage: "",
        characterName: "",
        text: "Он сел обратно в своё кресло, закинув ноги на стол",
        isNarrator: true,
        effect: null
    },
    {
        background: "url('arts/Harlekab.jpg')",
        characterImage: "arts/HarlequinoACT1.png",
        characterName: "???",
        text: "Тогда что ты здесь делаешь?",
        isNarrator: false,
        effect: null
    },
    {
        background: "url('arts/Harlekab.jpg')",
        characterImage: "arts/ref.png",
        characterName: "Вы",
        text: "Я фотограф. Меня пригласили сделать репортаж...",
        isNarrator: false,
        effect: null
    },
    {
        background: "url('arts/Harlekab.jpg')",
        characterImage: "arts/HarlequinoACT1.png",
        characterName: "???",
        text: "Пригласили? Я? Не припоминаю. Кто именно пригласил?",
        isNarrator: false,
        effect: null
    },
    {
        background: "url('arts/Harlekab.jpg')",
        characterImage: "arts/ref.png",
        characterName: "Вы",
        text: "Мне сказали, что руководитель цирка...",
        isNarrator: false,
        effect: null
    },
    {
        background: "url('arts/Harlekab.jpg')",
        characterImage: "",
        characterName: "",
        text: "Услышав это, мой собеседник встал со своего места вновь, сложил руки на груди и двинулся в мою сторону со странным спокойствием",
        isNarrator: true,
        effect: null
    },
    {
        background: "url('arts/Harlekab.jpg')",
        characterImage: "arts/HarlequinoACT1.png",
        characterName: "???",
        text: "А, руководитель! Да, да, понимаю...",
        isNarrator: false,
        effect: null
    },
    {
        background: "url('arts/Harlekab.jpg')",
        characterImage: "arts/HarlequinoACT1.png",
        characterName: "???",
        text: "Вот только дело в том, что руководитель - это я. И я тебе говорю — я НЕ приглашал тебя. А теперь скажи на милость, как ты вообще сюда попал?",
        isNarrator: false,
        effect: null
    },
    {
        background: "url('arts/Harlekab.jpg')",
        characterImage: "arts/ref.png",
        characterName: "Вы",
        text: "Мне открыл...",
        isNarrator: false,
        effect: null
    },
    {
        background: "url('arts/Harlekab.jpg')",
        characterImage: "",
        characterName: "",
        text: "Арлекин подошёл ко мне вплотную. Его рост оказался куда выше, чем я думал",
        isNarrator: true,
        effect: null
    },
    {
        background: "url('arts/Harlekab.jpg')",
        characterImage: "arts/HarlequinoACT1.png",
        characterName: "Арлекино",
        text: "Знаешь что? Мне сейчас некогда. У меня... небольшой инцидент. Весь цирк на ушах. А тут ещё ты со своими... фотографиями",
        isNarrator: false,
        effect: null
    },
    {
        background: "url('arts/Harlekab.jpg')",
        characterImage: "",
        characterName: "",
        text: "Его улыбка была широкой, но глаза оставались холодными, как лезвие ножа",
        isNarrator: true,
        effect: null
    },
    {
        background: "url('arts/Harlekab.jpg')",
        characterImage: "arts/HarlequinoACT1.png",
        characterName: "Арлекино",
        text: "Так что сделай мне одолжение — возьми свою камеру и проваливай. Не мешайся под ногами. Понял?",
        isNarrator: false,
        effect: null
    },
    {
        background: "url('arts/Harlekab.jpg')",
        characterImage: "arts/ref.png",
        characterName: "Вы",
        text: "Но...",
        isNarrator: false,
        effect: null
    },
    {
        background: "url('arts/Harlekab.jpg')",
        characterImage: "arts/HarlequinoACT1.png",
        characterName: "???",
        text: "ВОН!",
        isNarrator: false,
        effect: 'glitch'
    },
    {
        background: "url('arts/Harlekab.jpg')",
        characterImage: "",
        characterName: "",
        text: "Он указал на дверь пальцем, который дрожал от ярости. Я вышел. Дверь захлопнулась за моей спиной с таким грохотом, что задрожали стены",
        isNarrator: true,
        effect: null
    }
]
        };

                // Диалог на ночь
        const nightDialogue = [
            {
                background: "url('arts/area2.jpg')",
                characterImage: "",
                characterName: "",
                text: "Вечерело. Солнце зашло за горизонт уже часа два назад. Я наконец опросил всех, и артисты разошлись по своим комнатам",
                isNarrator: true,
                effect: null
            },
            {
                background: "url('arts/area2.jpg')",
                characterImage: "",
                characterName: "",
                text: "Я собирал оборудование, когда услышал шаги позади себя",
                isNarrator: true,
                effect: null
            },
            {
                background: "url('arts/area2.jpg')",
                characterImage: "arts/HarlequinoACT1.png",
                characterName: "???",
                text: "Вы ещё здесь?",
                isNarrator: false,
                effect: null
            },
            {
                background: "url('arts/area2.jpg')",
                characterImage: "arts/ref.png",
                characterName: "Вы",
                text: "Да, собираюсь уходить. Думал, вы уже ушли...",
                isNarrator: false,
                effect: null
            },
            {
                background: "url('arts/area2.jpg')",
                characterImage: "",
                characterName: "",
                text: "Это был арлекин. Он выглядел уставшим. Его обычно яркий костюм казался тусклым в слабом свете уцелевших прожекторов",
                isNarrator: true,
                effect: null
            },
            {
                background: "url('arts/area2.jpg')",
                characterImage: "arts/HarlequinoACT1.png",
                characterName: "???",
                text: "Хочу извиниться за сегодняшнее... поведение. У нас тут небольшой инцидент, и я был на взводе",
                isNarrator: false,
                effect: null
            },
            {
                background: "url('arts/area2.jpg')",
                characterImage: "",
                characterName: "",
                text: "Он помолчал, глядя куда-то в темноту за кулисами",
                isNarrator: true,
                effect: null
            },
            {
                background: "url('arts/area2.jpg')",
                characterImage: "arts/HarlequinoACT1.png",
                characterName: "???",
                text: "Но я видел, как вы работали сегодня. Успели поговорить со многими артистами. И... мне кажется, вы не доделали то, зачем пришли",
                isNarrator: false,
                effect: null
            },
            {
                background: "url('arts/area2.jpg')",
                characterImage: "arts/ref.png",
                characterName: "Вы",
                text: "Это было... интенсивно. Да, есть ещё кое-что, что хотелось бы узнать у артистов...",
                isNarrator: false,
                effect: null
            },
            {
                background: "url('arts/area2.jpg')",
                characterImage: "arts/HarlequinoACT1.png",
                characterName: "???",
                text: "Цирк закрывается на ночь. В городе уже темно, и дорога... небезопасна в это время",
                isNarrator: false,
                effect: null
            },
            {
                background: "url('arts/area2.jpg')",
                characterImage: "",
                characterName: "",
                text: "Его слова повисли в воздухе. Где-то вдалеке скрипнула дверь",
                isNarrator: true,
                effect: null
            },
            {
                background: "url('arts/area2.jpg')",
                characterImage: "arts/HarlequinoACT1.png",
                characterName: "???",
                text: "Моё имя Арлекино. Останьтесь здесь на ночь. У нас есть свободные комнаты в жилом крыле",
                isNarrator: false,
                effect: null
            },
            {
                background: "url('arts/area2.jpg')",
                characterImage: "arts/HarlequinoACT1.png",
                characterName: "Арлекино",
                text: "Считайте это моим способом извиниться",
                isNarrator: false,
                effect: null
            },
            {
                background: "url('arts/area2.jpg')",
                characterImage: "",
                characterName: "",
                text: "Он сделал паузу, и в этот момент я заметил Фата Моргану в дальнем конце арены",
                isNarrator: true,
                effect: null
            },
            {
                background: "url('arts/area2.jpg')",
                characterImage: "",
                characterName: "",
                text: "Две девушки стояли, обнявшись, и смотрели прямо на нас. Их улыбки были идентичными и немного... зловещими",
                isNarrator: true,
                effect: null
            },
            {
                background: "url('arts/area2.jpg')",
                characterImage: "",
                characterName: "",
                text: "Арлекино продолжил, не замечая их присутствия:",
                isNarrator: true,
                effect: null
            },
            {
                background: "url('arts/area2.jpg')",
                characterImage: "arts/HarlequinoACT1.png",
                characterName: "Арлекино",
                text: "Завтра утром сможете доснять интервью. Поговорить с теми, кого не успели. И...",
                isNarrator: false,
                effect: null
            },
            {
                background: "url('arts/area2.jpg')",
                characterImage: "arts/HarlequinoACT1.png",
                characterName: "Арлекино",
                text: "У нас будет специальная утренняя репетиция. Можете посмотреть подготовку к большому представлению",
                isNarrator: false,
                effect: null
            },
            {
                background: "url('arts/area2.jpg')",
                characterImage: "arts/ref.png",
                characterName: "Вы",
                text: "Я не знаю... это кажется...",
                isNarrator: false,
                effect: null
            },
            {
                background: "url('arts/area2.jpg')",
                characterImage: "",
                characterName: "",
                text: "Я бросил взгляд на Фата Моргану. Они синхронно кивнули, словно подталкивая меня к решению",
                isNarrator: true,
                effect: null
            },
            {
                background: "url('arts/area2.jpg')",
                characterImage: "",
                characterName: "",
                text: "Почему-то их одобрение не принесло облегчения",
                isNarrator: true,
                effect: null
            },
            {
                background: "url('arts/area2.jpg')",
                characterImage: "arts/ref.png",
                characterName: "Вы",
                text: "Вы правы... дорога ночью действительно небезопасна. Ладно, я останусь",
                isNarrator: false,
                effect: null
            },
            {
                background: "url('arts/area2.jpg')",
                characterImage: "arts/HarlequinoACT1.png",
                characterName: "Арлекино",
                text: "Мудрое решение. Пойдёмте, я покажу вам комнату",
                isNarrator: false,
                effect: null
            },
            {
                background: "url('arts/area2.jpg')",
                characterImage: "",
                characterName: "",
                text: "Я последовал за Арлекино по тёмным коридорам",
                isNarrator: true,
                effect: null
            },
            {
                background: "url('arts/Corridore.jpg')",
                characterImage: "",
                characterName: "",
                text: "Фонари мерцали, отбрасывая длинные тени",
                isNarrator: true,
                effect: null
            },
            {
                background: "url('arts/Corridore.jpg')",
                characterImage: "",
                characterName: "",
                text: "Из-за закрытых дверей слышались странные звуки",
                isNarrator: true,
                effect: null
            },
            {
                background: "url('arts/Corridore.jpg')",
                characterImage: "arts/HarlequinoACT1.png",
                characterName: "Арлекино",
                text: "Вот ваша комната. Спокойной ночи",
                isNarrator: false,
                effect: null
            },
            {
                background: "url('arts/Corridore.jpg')",
                characterImage: "arts/ref.png",
                characterName: "Вы",
                text: "Спокойной... ночи?",
                isNarrator: false,
                effect: null
            },
            {
                background: "url('arts/Corridore.jpg')",
                characterImage: "",
                characterName: "",
                text: "Дверь закрылась прямо перед моим носом, скрывая арлекина с другой стороны",
                isNarrator: true,
                effect: null
            },
            {
                background: "url('arts/room.jpg')",
                characterImage: "",
                characterName: "",
                text: "Я остался один в тёмной комнате",
                isNarrator: true,
                effect: null
            },
            {
                background: "url('arts/room.jpg')",
                characterImage: "",
                characterName: "",
                text: "А ведь ночь только начиналась...",
                isNarrator: true,
                effect: 'glitch'
            }
        ];

        // Функция запуска анимации ACT 1
        async function startActAnimation() {
            let delay = 0;
            
            letters.forEach((letterId, index) => {
                const letter = document.getElementById(letterId);
                
                setTimeout(() => {
                    smashSound.currentTime = 0;
                    smashSound.play();
                    
                    letter.style.transition = 'transform 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275), opacity 0.5s';
                    letter.style.opacity = '1';
                    letter.style.transform = 'scale(1) translateY(0)';
                }, delay);
                
                delay += 800;
            });
            
            setTimeout(() => {
                letters.forEach(letterId => {
                    const letter = document.getElementById(letterId);
                    letter.classList.add('flicker');
                });
            }, delay + 500);
            
            // Плавный переход через чёрный экран
            setTimeout(async () => {
                actContainer.style.display = 'none';
                postActFade.style.opacity = '1';
                
                // Медленное высветление чёрного экрана
                setTimeout(() => {
                    postActFade.style.transition = 'opacity 2s ease';
                    postActFade.style.opacity = '0';
                    
                    setTimeout(() => {
                        postActFade.style.display = 'none';
                        showArea();
                    }, 2000);
                }, 1000);
            }, 5000);
        }

        // Показать Area и загрузить изображения точек
        function showArea() {
            areaContainer.style.display = 'block';
            gameState.currentLocation = 'area';
            
            // Загружаем изображения для всех точек
            document.querySelectorAll('.point').forEach(point => {
                const image = point.getAttribute('data-image');
                if (image) {
                    point.style.backgroundImage = `url('${image}')`;
                }
            });
            
            fadeInMusic(menuMusic, 0.6);
            dialogueCounter.style.display = 'block';
            updateDialogueCounter();
            showAllInteractiveElements();
        }

        // Показать коридор слева
        function showRoomsLeft() {
            if (gameState.isDialogActive) return;
            
            areaContainer.style.display = 'none';
            roomsLeftContainer.style.display = 'block';
            gameState.currentLocation = 'roomsLeft';
            
            // Обновляем фон
            document.body.style.backgroundImage = "url('arts/Corridore.jpg')";
            
            showAllInteractiveElements();
        }

        // Показать коридор справа
        function showRoomsRight() {
            if (gameState.isDialogActive) return;
            
            areaContainer.style.display = 'none';
            roomsRightContainer.style.display = 'block';
            gameState.currentLocation = 'roomsRight';
            
            // Обновляем фон
            document.body.style.backgroundImage = "url('arts/Corridore.jpg')";
            
            showAllInteractiveElements();
        }

        // Показать кабинет Арлекино
        function showHarlekab() {
            if (gameState.isDialogActive) return;
            
            roomsRightContainer.style.display = 'none';
            harlekabContainer.style.display = 'block';
            gameState.currentLocation = 'harlekab';
            
            // Обновляем фон
            document.body.style.backgroundImage = "url('arts/Harlekab.jpg')";
            
            fadeOutMusic(menuMusic);
            setTimeout(() => {
                fadeInMusic(sanctumMusic, 0.6);
            }, 500);
            
            showAllInteractiveElements();
        }

        // Вернуться из кабинета Арлекино
        function returnFromHarlekab() {
            if (gameState.isDialogActive) return;
            
            harlekabContainer.style.display = 'none';
            roomsRightContainer.style.display = 'block';
            gameState.currentLocation = 'roomsRight';
            
            // Обновляем фон
            document.body.style.backgroundImage = "url('arts/Corridore.jpg')";
            
            fadeOutMusic(sanctumMusic);
            setTimeout(() => {
                fadeInMusic(menuMusic, 0.6);
            }, 500);
            
            showAllInteractiveElements();
        }

        // Вернуться в Area из коридоров
        function returnToArea(fromLeft = true) {
            if (gameState.isDialogActive) return;
            
            if (fromLeft) {
                roomsLeftContainer.style.display = 'none';
            } else {
                roomsRightContainer.style.display = 'none';
            }
            areaContainer.style.display = 'block';
            gameState.currentLocation = 'area';
            
            // Обновляем фон
            document.body.style.backgroundImage = "url('arts/area.jpg')";
            
            showAllInteractiveElements();
        }

        // Плавное затухание музыки
        function fadeOutMusic(audioElement) {
            let volume = audioElement.volume;
            const fadeOutInterval = setInterval(() => {
                if (volume > 0) {
                    volume -= 0.1;
                    audioElement.volume = Math.max(0, volume);
                } else {
                    clearInterval(fadeOutInterval);
                    audioElement.pause();
                    audioElement.currentTime = 0;
                }
            }, 100);
        }

        // Плавное включение музыки
        function fadeInMusic(audioElement, targetVolume) {
            audioElement.volume = 0;
            audioElement.currentTime = 0;
            audioElement.play();
            
            let volume = 0;
            const fadeInInterval = setInterval(() => {
                if (volume < targetVolume) {
                    volume += 0.1;
                    audioElement.volume = Math.min(targetVolume, volume);
                } else {
                    clearInterval(fadeInInterval);
                }
            }, 100);
        }

        // Смена музыки для диалогов
        function switchToDialogueMusic() {
            // НЕ переключаем музыку для стрелки вверх
            if (gameState.isArrowUpDialogue) return;
            
            if (gameState.currentLocation === 'harlekab') {
                fadeOutMusic(sanctumMusic);
            } else {
                fadeOutMusic(menuMusic);
            }
            
            setTimeout(() => {
                fadeInMusic(trustMusic, 0.4);
            }, 500);
        }

        // Возврат к основной музыке
        function switchToMainMusic() {
            // НЕ переключаем музыку для стрелки вверх
            if (gameState.isArrowUpDialogue) return;
            
            fadeOutMusic(trustMusic);
            
            setTimeout(() => {
                if (gameState.currentLocation === 'harlekab') {
                    fadeInMusic(sanctumMusic, 0.6);
                } else {
                    fadeInMusic(menuMusic, 0.6);
                }
            }, 500);
        }

        // Обновить счётчик диалогов
        function updateDialogueCounter() {
            dialogueCounter.textContent = `${gameState.dialogueCount}/${gameState.maxDialogues}`;
        }

        // Увеличить счётчик диалогов
        function incrementDialogueCounter() {
            if (gameState.dialogueCount < gameState.maxDialogues) {
                gameState.dialogueCount++;
                updateDialogueCounter();
            }
        }

        // Скрыть все интерактивные элементы
        function hideAllInteractiveElements() {
            document.querySelectorAll('.point, .nav-arrow, .room-button').forEach(el => {
                el.style.visibility = 'hidden';
            });
        }

        // Показать все интерактивные элементы в текущей локации
        function showAllInteractiveElements() {
            // Сначала скрываем все
            hideAllInteractiveElements();
            
            // Затем показываем только нужные для текущей локации
            switch(gameState.currentLocation) {
                case 'area':
                    document.querySelectorAll('#areaContainer .point').forEach(point => {
                        const name = point.getAttribute('data-name');
                        if (gameState.talkedWithCharacters.has(name)) {
                            point.classList.add('disabled');
                        } else {
                            point.classList.remove('disabled');
                        }
                        point.style.visibility = 'visible';
                    });
                    
                    document.querySelectorAll('#areaContainer .nav-arrow').forEach(arrow => {
                        arrow.style.visibility = 'visible';
                        if (arrow.id === 'areaArrowUp' && gameState.arrowUpDisabled) {
                            arrow.classList.add('disabled');
                        }
                    });
                    break;
                    
                case 'roomsLeft':
                    document.querySelectorAll('#roomsLeftContainer .room-button, #roomsLeftContainer .nav-arrow').forEach(el => {
                        el.style.visibility = 'visible';
                    });
                    break;
                    
                case 'roomsRight':
                    document.querySelectorAll('#roomsRightContainer .room-button, #roomsRightContainer .nav-arrow').forEach(el => {
                        el.style.visibility = 'visible';
                    });
                    break;
                    
                case 'harlekab':
                    const harlequinPoint = document.querySelector('#harlekabContainer .point');
                    if (gameState.talkedWithCharacters.has('Арлекино')) {
                        harlequinPoint.classList.add('disabled');
                    } else {
                        harlequinPoint.classList.remove('disabled');
                    }
                    harlequinPoint.style.visibility = 'visible';
                    
                    document.querySelector('#harlekabContainer .nav-arrow').style.visibility = 'visible';
                    break;
            }
        }

        // НАЧАЛО ДИАЛОГА
        function startDialogue(characterName) {
            if (gameState.talkedWithCharacters.has(characterName) || 
                gameState.isDialogActive || 
                !dialogues[characterName]) {
                return;
            }
            
            gameState.isDialogActive = true;
            gameState.isArrowUpDialogue = false;
            
            // Скрываем элементы
            hideAllInteractiveElements();
            
            // Устанавливаем диалог
            gameState.currentDialogue = dialogues[characterName];
            gameState.currentScene = 0;
            gameState.currentCharacter = characterName;
            gameState.canAdvance = true;
            
            if (!gameState.isArrowUpDialogue) {
                switchToDialogueMusic();
            }
            
            dialogueContainer.style.display = 'flex';
            characterNameTop.style.display = 'block';
            
            updateDialogueScene();
        }

        // Обработка стрелки вверх
        function handleArrowUp() {
            if (gameState.arrowUpDisabled || gameState.isDialogActive) return;
            
            gameState.isDialogActive = true;
            gameState.isArrowUpDialogue = true;
            
            // Скрываем элементы
            hideAllInteractiveElements();
            
            if (gameState.arrowUpClicks < 5) {
                gameState.currentDialogue = arrowUpDialogues[gameState.arrowUpClicks];
                gameState.currentScene = 0;
                gameState.canAdvance = true;
                gameState.arrowUpClicks++;
            } else if (gameState.arrowUpClicks === 5) {
                gameState.currentDialogue = arrowUpFinalScript;
                gameState.currentScene = 0;
                gameState.canAdvance = true;
                gameState.arrowUpClicks++;
            } else {
                gameState.arrowUpDisabled = true;
                areaArrowUp.classList.add('disabled');
                gameState.isDialogActive = false;
                gameState.isArrowUpDialogue = false;
                showAllInteractiveElements();
                return;
            }
            
            dialogueContainer.style.display = 'flex';
            characterNameTop.style.display = 'block';
            updateDialogueScene();
        }

        // ОБНОВЛЕНИЕ СЦЕНЫ ДИАЛОГА
        function updateDialogueScene() {
            if (gameState.currentScene >= gameState.currentDialogue.length) {
                endDialogue();
                return;
            }
            
            const scene = gameState.currentDialogue[gameState.currentScene];
            
            // Устанавливаем фон
            if (scene.background) {
                document.body.style.backgroundImage = scene.background;
            }
            
            // Устанавливаем имя персонажа
            characterNameTop.textContent = scene.characterName;
            
            // Устанавливаем портрет
            if (scene.characterImage && !scene.isNarrator) {
                characterPortrait.src = scene.characterImage;
                characterPortrait.style.display = 'block';
                characterNameTop.style.display = 'block';
            } else {
                characterPortrait.style.display = 'none';
                characterNameTop.style.display = scene.isNarrator ? 'none' : 'block';
            }
            
            // Устанавливаем текст
            dialogueText.textContent = scene.text;
            
            // Правильно применяем класс narrator
            dialogueText.className = 'dialogue-text';
            
            if (scene.isNarrator) {
                dialogueText.classList.add('narrator');
            }
            
            // Применяем эффекты
            applyTextEffect(scene.effect);
        }

        // ПРИМЕНЕНИЕ ЭФФЕКТОВ ТЕКСТА
        function applyTextEffect(effectType) {
            dialogueText.classList.remove('glitch-text', 'distorted-text', 'earthquake-text', 'earthquake-text strong');
            
            if (effectType === 'glitch') {
                dialogueText.classList.add('glitch-text');
            } else if (effectType === 'distorted') {
                dialogueText.classList.add('distorted-text');
            } else if (effectType === 'earthquake') {
                dialogueText.classList.add('earthquake-text');
            } else if (effectType === 'earthquake-strong') {
                dialogueText.classList.add('earthquake-text', 'strong');
            }
        }

        // ПЕРЕХОД К СЛЕДУЮЩЕЙ СЦЕНЕ
        function nextDialogueScene() {
            if (!gameState.canAdvance || !gameState.isDialogActive) return;
            
            if (gameState.currentScene < gameState.currentDialogue.length - 1) {
                gameState.currentScene++;
                updateDialogueScene();
            } else {
                endDialogue();
            }
        }

        // ЗАВЕРШЕНИЕ ДИАЛОГА
        function endDialogue() {
            if (!gameState.isDialogActive) return;
            
            gameState.canAdvance = false;
            
            // Скрываем диалоговое окно
            dialogueContainer.style.display = 'none';
            characterPortrait.style.display = 'none';
            characterNameTop.style.display = 'none';
            
            // Если это был обычный диалог с персонажем
            if (gameState.currentCharacter && !gameState.talkedWithCharacters.has(gameState.currentCharacter) &&
                dialogues[gameState.currentCharacter]) {
                
                // Добавляем персонажа в список разговорённых
                gameState.talkedWithCharacters.add(gameState.currentCharacter);
                incrementDialogueCounter();
                
                if (!gameState.isArrowUpDialogue) {
                    switchToMainMusic();
                }
            }
            
            // Восстанавливаем фон
            if (gameState.currentLocation === 'area') {
                document.body.style.backgroundImage = "url('arts/area.jpg')";
            } else if (gameState.currentLocation === 'harlekab') {
                document.body.style.backgroundImage = "url('arts/Harlekab.jpg')";
            } else if (gameState.currentLocation === 'roomsLeft' || gameState.currentLocation === 'roomsRight') {
                document.body.style.backgroundImage = "url('arts/Corridore.jpg')";
            }
            
            // Если все диалоги завершены и это был не диалог со стрелкой вверх
            if (gameState.dialogueCount >= gameState.maxDialogues && 
                gameState.currentCharacter && 
                !gameState.isArrowUpDialogue) {
                
                // Запускаем финальный диалог с небольшой задержкой
                setTimeout(() => {
                    startFinalDialogue();
                }, 100);
                return;
            }
            
            // Сбрасываем состояния
            gameState.isDialogActive = false;
            gameState.currentCharacter = '';
            gameState.isArrowUpDialogue = false;
            
            // Показываем интерактивные элементы
            showAllInteractiveElements();
        }

        // Финальный диалог ночи
        function startFinalDialogue() {
            if (gameState.isDialogActive) return;
            
            gameState.isDialogActive = true;
            gameState.isArrowUpDialogue = false;
            
            // Скрываем элементы
            hideAllInteractiveElements();
            
            gameState.currentDialogue = nightDialogue;
            gameState.currentScene = 0;
            gameState.currentCharacter = '';
            gameState.canAdvance = true;
            
            switchToDialogueMusic();
            
            dialogueContainer.style.display = 'flex';
            characterNameTop.style.display = 'block';
            
            updateDialogueScene();
        }

        // Обработчики событий
        document.addEventListener('DOMContentLoaded', () => {
            setTimeout(startActAnimation, 500);
            
            // Клик по точкам на Area
            document.querySelectorAll('#areaContainer .point').forEach(point => {
                point.addEventListener('click', () => {
                    if (gameState.isDialogActive) return;
                    
                    const name = point.getAttribute('data-name');
                    if (!point.classList.contains('disabled')) {
                        startDialogue(name);
                    }
                });
            });
            
            // Стрелки на Area
            areaArrowUp.addEventListener('click', handleArrowUp);
            areaArrowLeft.addEventListener('click', () => showRoomsLeft());
            areaArrowRight.addEventListener('click', () => showRoomsRight());
            
            // Стрелка возврата из левого коридора
            roomsLeftArrowRight.addEventListener('click', () => {
                if (!gameState.isDialogActive) {
                    returnToArea(true);
                }
            });
            
            // Стрелка возврата из правого коридора
            roomsRightArrowLeft.addEventListener('click', () => {
                if (!gameState.isDialogActive) {
                    returnToArea(false);
                }
            });
            
            // Кнопка комнаты Арлекино
            document.querySelector('#roomsRightContainer .room-button[data-room="Арлекино"]').addEventListener('click', () => {
                if (!gameState.isDialogActive) {
                    showHarlekab();
                }
            });
            
            // Точка Арлекино в кабинете
            document.querySelector('#harlekabContainer .point').addEventListener('click', () => {
                if (!gameState.isDialogActive) {
                    const name = document.querySelector('#harlekabContainer .point').getAttribute('data-name');
                    if (!document.querySelector('#harlekabContainer .point').classList.contains('disabled')) {
                        startDialogue(name);
                    }
                }
            });
            
            // Стрелка возврата из кабинета Арлекино
            harlekabArrowRight.addEventListener('click', () => {
                if (!gameState.isDialogActive) {
                    returnFromHarlekab();
                }
            });
            
            // Клик по диалоговому окну
            dialogueContainer.addEventListener('click', () => {
                nextDialogueScene();
            });
            
            // Пробел для перехода - ИСПРАВЛЕННАЯ ВЕРСИЯ
            document.addEventListener('keydown', function(event) {
                if (event.code === 'Space') {
                    event.preventDefault();
                    if (gameState.canAdvance && gameState.isDialogActive) {
                        nextDialogueScene();
                    }
                }
            });
        });

        // Обработка ошибок изображений для точек
        document.querySelectorAll('.point').forEach(point => {
            point.addEventListener('error', function() {
                const name = this.getAttribute('data-name');
                this.style.backgroundImage = "none";
                this.style.backgroundColor = "rgba(100, 0, 30, 0.8)";
                this.innerHTML = `<span style="color: white; font-weight: bold;">${name.charAt(0)}</span>`;
            });
        });

        // Обработка ошибок изображений для портретов
        characterPortrait.onerror = function() {
            this.src = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgZmlsbD0iIzIyMiIvPjx0ZXh0IHg9IjUwIiB5PSI1MCIgZm9udC1mYW1pbHk9IkFyaWFsIiBmb250LXNpplp9IjE0IiBmaWxsPSJ3aGl0ZSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgYWxpZ25tZW50LWJhc2VsaW5lPSJtaWRkbGUiPuKEoiA8L3RleHQ+PC9zdmc+';
        };
    </script>
</body>
</html>